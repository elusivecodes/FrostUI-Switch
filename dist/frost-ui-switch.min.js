!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,e,i){"use strict";class s extends e.BaseComponent{constructor(t,s){super(t,s);const n=i.getAttribute(this._node,"id");this._label=i.findOne(`label[for="${n}"]`),this._label&&!i.getAttribute(this._label,"id")&&(i.setAttribute(this._label,{id:e.generateId("switch-label")}),this._labelId=!0),this._render(),this._refresh(),this._refreshDisabled(),this._events(),this._currentX=-this._toggleWidth;const o=i.getProperty(this._node,"checked");this._animateState(o)}disable(){i.setAttribute(this._node,{disabled:!0}),this._refreshDisabled()}dispose(){this._labelId&&i.removeAttribute(this._label,"id"),i.remove(this._outerContainer),i.removeEvent(this._node,"focus.ui.switch"),i.removeEvent(this._node,"change.ui.switch"),i.removeAttribute(this._node,"tabindex"),i.removeClass(this._node,this.constructor.classes.hide),this._label=null,this._outerContainer=null,this._container=null,this._onToggle=null,this._divider=null,this._offToggle=null,super.dispose()}enable(){i.removeAttribute(this._node,"disabled"),this._refreshDisabled()}getState(){return i.getProperty(this._node,"checked")}setState(t){this._animateState(t)}toggleState(){const t=this.getState();this._animateState(!t)}}s.defaults={size:"md",onStyle:"text-bg-primary",offStyle:"text-bg-secondary",dividerStyle:"bg-body-tertiary",onText:"ON",offText:"OFF",labelWidth:null,dividerWidth:null,animate:!0,duration:500},s.classes={disabled:"switch-disabled",hide:"visually-hidden",outer:"switch-outer",switch:"switch",toggleDivider:"switch-toggle-divider",toggleOff:"switch-toggle-off",toggleOn:"switch-toggle-on"};const n=s.prototype;n._animateState=function(t){if(i.getDataset(this._container,"uiSliding"))return;let e,s;if(i.getDataset(this._container,"uiAnimating")&&i.stop(this._container,{finish:!1}),t?(e=0,s=(this._toggleWidth-Math.abs(this._currentX))/this._toggleWidth):(e=-this._toggleWidth,s=Math.abs(this._currentX)/this._toggleWidth),!this._options.animate||s>=1)return i.setStyle(this._container,{transform:`translateX(${e}px)`}),this._currentX=e,this._setState(t),void i.removeDataset(this._container,"uiAnimating");const n=1-s;i.setDataset(this._container,{uiAnimating:!0}),i.animate(this._container,((t,o)=>{this._currentX=i._lerp(this._currentX,e,s+o*n),i.setStyle(t,{transform:`translateX(${this._currentX}px)`})}),{duration:this._options.duration*n}).then((s=>{i.removeDataset(this._container,"uiAnimating"),this._currentX=e,this._setState(t)})).catch((t=>{i.removeDataset(this._container,"uiAnimating")}))},n._events=function(){let t;i.addEvent(this._node,"focus.ui.switch",(t=>{i.focus(this._outerContainer)})),i.addEvent(this._node,"change.ui.switch",(t=>{if(t.skipUpdate||i.getDataset(this._container,"uiAnimating")||i.getDataset(this._container,"uiSliding"))return;const e=this.getState();this._animateState(e)})),i.addEvent(this._outerContainer,"keyup.ui.switch",(t=>{"Space"!==t.code||i.getDataset(this._container,"uiAnimating")||i.getDataset(this._container,"uiSliding")||this.toggleState()})),i.addEvent(this._outerContainer,"click.ui.switch",(t=>{t.button||i.getDataset(this._container,"uiAnimating")||i.getDataset(this._container,"uiSliding")||this.toggleState()}));const s=i.mouseDragFactory((s=>{if(s.button||i.getDataset(this._container,"uiAnimating")||i.getDataset(this._container,"uiSliding"))return!1;const n=e.getPosition(s);t=n.x-this._currentX}),(s=>{i.getDataset(this._container,"uiSliding")||i.setDataset(this._container,{uiSliding:!0});const n=e.getPosition(s).x;this._currentX=i._clamp(n-t,-this._toggleWidth,0),i.setStyle(this._container,{transform:`translateX(${this._currentX}px)`})}),(t=>{if(!i.getDataset(this._container,"uiSliding"))return;const e=Math.abs(this._currentX)<this._toggleWidth/2;setTimeout((t=>{i.removeDataset(this._container,"uiSliding"),this._animateState(e)}),0)}));i.addEvent(this._outerContainer,"mousedown.ui.switch touchstart.ui.switch",s)},n._refresh=function(){this._options.labelWidth?this._toggleWidth=this._options.labelWidth:this._toggleWidth=Math.max(i.width(this._onToggle),i.width(this._offToggle)),this._options.dividerWidth?this._dividerWidth=this._options.dividerWidth:this._dividerWidth=this._toggleWidth/2;const t=this._toggleWidth+this._dividerWidth,e=2*this._toggleWidth+this._dividerWidth;i.setStyle(this._outerContainer,{width:`${t}px`}),i.setStyle(this._container,{width:`${e}px`,transform:`translateX(${-this._toggleWidth}px)`}),i.setStyle(this._onToggle,{width:`${this._toggleWidth}px`}),i.setStyle(this._divider,{width:`${this._dividerWidth}px`}),i.setStyle(this._offToggle,{width:`${this._toggleWidth}px`})},n._refreshDisabled=function(){const t=i.is(this._node,":disabled");t?i.addClass(this._outerContainer,this.constructor.classes.disabled):i.removeClass(this._outerContainer,this.constructor.classes.disabled),i.setAttribute(this._outerContainer,{"aria-disabled":t,tabindex:t?-1:0})},n._render=function(){if(this._outerContainer=i.create("div",{class:[this.constructor.classes.outer,`switch-${this._options.size}`],attributes:{role:"switch","aria-checked":this.getState(),"aria-required":i.getProperty(this._node,"required")}}),this._label){const t=i.getAttribute(this._label,"id");i.setAttribute(this._outerContainer,{"aria-labelledby":t})}this._container=i.create("div",{class:this.constructor.classes.switch,attributes:{"aria-hidden":!0}}),this._onToggle=i.create("div",{class:[this.constructor.classes.toggleOn,this._options.onStyle],text:this._options.onText}),this._divider=i.create("div",{class:[this.constructor.classes.toggleDivider,this._options.dividerStyle],text:""}),this._offToggle=i.create("div",{class:[this.constructor.classes.toggleOff,this._options.offStyle],text:this._options.offText}),i.append(this._container,this._onToggle),i.append(this._container,this._divider),i.append(this._container,this._offToggle),i.append(this._outerContainer,this._container),i.addClass(this._node,this.constructor.classes.hide),i.setAttribute(this._node,{tabindex:-1}),i.before(this._node,this._outerContainer)},n._setState=function(t){i.setAttribute(this._outerContainer,{"aria-checked":t}),this.getState()!==t&&(i.setProperty(this._node,{checked:t}),i.triggerEvent(this._node,"change.ui.switch",{data:{skipUpdate:!0}}))},e.initComponent("switch",s),t.Switch=s}));