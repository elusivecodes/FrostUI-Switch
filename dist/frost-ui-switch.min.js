!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,i,e){"use strict";class s extends i.BaseComponent{constructor(t,i){super(t,i),this._render(),this._refresh(),this._refreshDisabled(),this._events(),this._currentX=-this._toggleWidth;const s=e.getProperty(this._node,"checked");this._animateState(s)}disable(){e.setAttribute(this._node,{disabled:!0}),this._refreshDisabled()}dispose(){e.remove(this._outerContainer),e.removeEvent(this._node,"focus.ui.switch"),e.removeEvent(this._node,"change.ui.switch"),e.removeAttribute(this._node,"tabindex"),e.removeClass(this._node,this.constructor.classes.hide),this._outerContainer=null,this._container=null,this._onToggle=null,this._divider=null,this._offToggle=null,super.dispose()}enable(){e.removeAttribute(this._node,"disabled"),this._refreshDisabled()}getState(){return e.getProperty(this._node,"checked")}setState(t){this._animateState(t)}toggleState(){const t=this.getState();this._animateState(!t)}}s.defaults={size:"md",onStyle:"text-bg-primary",offStyle:"text-bg-secondary",dividerStyle:"bg-body-tertiary",onText:"ON",offText:"OFF",labelWidth:null,dividerWidth:null,animate:!0,duration:500},s.classes={disabled:"switch-disabled",hide:"visually-hidden",outer:"switch-outer",switch:"switch",toggleDivider:"switch-toggle-divider",toggleOff:"switch-toggle-off",toggleOn:"switch-toggle-on"};const n=s.prototype;n._animateState=function(t){if(e.getDataset(this._container,"uiSliding"))return;let i,s;if(e.getDataset(this._container,"uiAnimating")&&e.stop(this._container,{finish:!1}),t?(i=0,s=(this._toggleWidth-Math.abs(this._currentX))/this._toggleWidth):(i=-this._toggleWidth,s=Math.abs(this._currentX)/this._toggleWidth),!this._options.animate||s>=1)return e.setStyle(this._container,{transform:`translateX(${i}px)`}),this._currentX=i,this._setState(t),void e.removeDataset(this._container,"uiAnimating");const n=1-s;e.setDataset(this._container,{uiAnimating:!0}),e.animate(this._container,((t,o)=>{this._currentX=e._lerp(this._currentX,i,s+o*n),e.setStyle(t,{transform:`translateX(${this._currentX}px)`})}),{duration:this._options.duration*n}).then((s=>{e.removeDataset(this._container,"uiAnimating"),this._currentX=i,this._setState(t)})).catch((t=>{e.removeDataset(this._container,"uiAnimating")}))},n._events=function(){let t;e.addEvent(this._node,"focus.ui.switch",(t=>{e.focus(this._outerContainer)})),e.addEvent(this._node,"change.ui.switch",(t=>{if(t.skipUpdate||e.getDataset(this._container,"uiAnimating")||e.getDataset(this._container,"uiSliding"))return;const i=this.getState();this._animateState(i)})),e.addEvent(this._outerContainer,"keyup.ui.switch",(t=>{"Space"!==t.code||e.getDataset(this._container,"uiAnimating")||e.getDataset(this._container,"uiSliding")||this.toggleState()})),e.addEvent(this._outerContainer,"click.ui.switch",(t=>{t.button||e.getDataset(this._container,"uiAnimating")||e.getDataset(this._container,"uiSliding")||this.toggleState()}));const s=e.mouseDragFactory((s=>{if(s.button||e.getDataset(this._container,"uiAnimating")||e.getDataset(this._container,"uiSliding"))return!1;const n=i.getPosition(s);t=n.x-this._currentX}),(s=>{e.getDataset(this._container,"uiSliding")||e.setDataset(this._container,{uiSliding:!0});const n=i.getPosition(s).x;this._currentX=e._clamp(n-t,-this._toggleWidth,0),e.setStyle(this._container,{transform:`translateX(${this._currentX}px)`})}),(t=>{if(!e.getDataset(this._container,"uiSliding"))return;const i=Math.abs(this._currentX)<this._toggleWidth/2;setTimeout((t=>{e.removeDataset(this._container,"uiSliding"),this._animateState(i)}),0)}));e.addEvent(this._outerContainer,"mousedown.ui.switch touchstart.ui.switch",s)},n._refresh=function(){this._options.labelWidth?this._toggleWidth=this._options.labelWidth:this._toggleWidth=Math.max(e.width(this._onToggle),e.width(this._offToggle)),this._options.dividerWidth?this._dividerWidth=this._options.dividerWidth:this._dividerWidth=this._toggleWidth/2;const t=this._toggleWidth+this._dividerWidth,i=2*this._toggleWidth+this._dividerWidth;e.setStyle(this._outerContainer,{width:`${t}px`}),e.setStyle(this._container,{width:`${i}px`,transform:`translateX(${-this._toggleWidth}px)`}),e.setStyle(this._onToggle,{width:`${this._toggleWidth}px`}),e.setStyle(this._divider,{width:`${this._dividerWidth}px`}),e.setStyle(this._offToggle,{width:`${this._toggleWidth}px`})},n._refreshDisabled=function(){e.is(this._node,":disabled")?e.addClass(this._outerContainer,this.constructor.classes.disabled):e.removeClass(this._outerContainer,this.constructor.classes.disabled)},n._render=function(){this._outerContainer=e.create("div",{class:[this.constructor.classes.outer,`switch-${this._options.size}`],attributes:{tabindex:0}}),this._container=e.create("div",{class:this.constructor.classes.switch}),this._onToggle=e.create("div",{class:[this.constructor.classes.toggleOn,this._options.onStyle],text:this._options.onText}),this._divider=e.create("div",{class:[this.constructor.classes.toggleDivider,this._options.dividerStyle],text:""}),this._offToggle=e.create("div",{class:[this.constructor.classes.toggleOff,this._options.offStyle],text:this._options.offText}),e.append(this._container,this._onToggle),e.append(this._container,this._divider),e.append(this._container,this._offToggle),e.append(this._outerContainer,this._container),e.addClass(this._node,this.constructor.classes.hide),e.setAttribute(this._node,{tabindex:-1}),e.before(this._node,this._outerContainer)},n._setState=function(t){this.getState()!==t&&(e.setProperty(this._node,{checked:t},{data:{skipUpdate:!0}}),e.triggerEvent(this._node,"change.ui.switch"))},i.initComponent("switch",s),t.Switch=s}));